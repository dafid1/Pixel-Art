<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>إحصائيات المشاريع | بيكسل آرت</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* المتغيرات الأساسية */
        :root {
            /* نظام الألوان */
            --primary-color: #0a9396;
            --primary-dark: #005f73;
            --primary-light: #94d2bd;
            --secondary-color: #ee9b00;
            --secondary-dark: #ca6702;
            --secondary-light: #ffb347;
            --accent-color: #9b5de5;
            --accent-dark: #7209b7;
            --success-color: #2a9d8f;
            --warning-color: #e9c46a;
            --danger-color: #e76f51;
            --info-color: #4cc9f0;
            
            /* نظام التصميم */
            --bg-primary: rgba(255, 255, 255, 0.98);
            --bg-secondary: rgba(248, 250, 252, 0.96);
            --bg-tertiary: rgba(241, 245, 249, 0.95);
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --border-color: rgba(226, 232, 240, 0.95);
            --shadow-color: rgba(0, 0, 0, 0.08);
            --shadow-heavy: rgba(0, 0, 0, 0.15);
            
            /* الأنيميشن */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-medium: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* التأثيرات */
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.25);
            --backdrop-blur: blur(20px);
            --backdrop-saturate: saturate(180%);
            
            /* الطبقات */
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-fixed: 1030;
            --z-modal-backdrop: 1040;
            --z-modal: 1050;
            --z-popover: 1060;
            --z-tooltip: 1070;
            --z-toast: 1080;
        }

        /* الوضع الداكن */
        .dark-mode {
            --bg-primary: rgba(15, 23, 42, 0.98);
            --bg-secondary: rgba(30, 41, 59, 0.96);
            --bg-tertiary: rgba(51, 65, 85, 0.95);
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border-color: rgba(71, 85, 105, 0.95);
            --shadow-color: rgba(0, 0, 0, 0.3);
            --shadow-heavy: rgba(0, 0, 0, 0.4);
            --glass-bg: rgba(15, 23, 42, 0.85);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Cairo', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, 
                rgba(10, 147, 150, 0.05) 0%,
                rgba(238, 155, 0, 0.05) 50%,
                rgba(155, 93, 229, 0.05) 100%);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* تأثير الخلفية الديناميكية */
        .dynamic-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .gradient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            animation: float 20s infinite ease-in-out;
        }

        .orb-1 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, var(--primary-color) 0%, transparent 70%);
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, var(--secondary-color) 0%, transparent 70%);
            top: 60%;
            right: 10%;
            animation-delay: -5s;
        }

        .orb-3 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, var(--accent-color) 0%, transparent 70%);
            bottom: 10%;
            left: 20%;
            animation-delay: -10s;
        }

        /* شريط الحالة الذكي */
        .smart-status-bar {
            height: 44px;
            background: linear-gradient(90deg, 
                var(--primary-color) 0%,
                var(--secondary-color) 50%,
                var(--accent-color) 100%);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: var(--z-fixed);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .status-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .status-badge i {
            animation: pulse 2s infinite;
        }

        /* الهيدر الرئيسي */
        .main-header {
            height: 80px;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            border-bottom: 1px solid var(--glass-border);
            padding: 0 24px;
            position: fixed;
            top: 44px;
            left: 0;
            right: 0;
            z-index: var(--z-sticky);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .brand-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 22px;
            box-shadow: 0 8px 32px rgba(10, 147, 150, 0.3);
            transition: transform var(--transition-medium);
        }

        .logo-icon:hover {
            transform: rotate(15deg) scale(1.1);
        }

        .logo-text h1 {
            font-size: 22px;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }

        .logo-text span {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .header-back {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 16px;
            transition: all var(--transition-fast);
        }

        .header-back:hover {
            color: var(--primary-color);
        }

        .header-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--text-primary);
            margin: 0;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-action {
            width: 48px;
            height: 48px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }

        .header-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px var(--shadow-color);
            color: var(--primary-color);
        }

        .action-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: linear-gradient(135deg, var(--danger-color), #d1664b);
            color: white;
            min-width: 20px;
            height: 20px;
            border-radius: 10px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 6px;
            font-weight: 700;
            border: 2px solid var(--bg-primary);
            box-shadow: 0 2px 8px rgba(231, 111, 81, 0.3);
        }

        /* المحتوى الرئيسي */
        .main-content {
            padding: 124px 0 100px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .projects-container {
            padding: 0 24px;
        }

        /* بطاقة نظرة عامة على المشاريع */
        .projects-overview-card {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 0 20px 60px var(--shadow-heavy);
            border: 1px solid var(--glass-border);
            margin-bottom: 32px;
            position: relative;
        }

        .projects-overview-header {
            padding: 32px;
            background: linear-gradient(135deg, 
                rgba(10, 147, 150, 0.1) 0%,
                rgba(238, 155, 0, 0.1) 50%,
                rgba(155, 93, 229, 0.1) 100%);
            border-bottom: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .projects-overview-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .overview-title {
            font-size: 28px;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .overview-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            position: relative;
            z-index: 1;
        }

        .overview-controls {
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .control-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .control-select {
            padding: 12px 20px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 14px;
            font-family: inherit;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            min-width: 180px;
        }

        .control-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(10, 147, 150, 0.1);
        }

        .control-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(10, 147, 150, 0.3);
        }

        /* إحصائيات المشاريع */
        .projects-stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 32px;
            background: var(--bg-secondary);
        }

        .project-stat {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid var(--glass-border);
            transition: all var(--transition-medium);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .project-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .project-stat:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px var(--shadow-heavy);
            border-color: var(--primary-color);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .stat-info h3 {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 900;
            color: var(--text-primary);
            line-height: 1;
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 700;
            margin-top: 8px;
        }

        .trend-positive {
            color: var(--success-color);
        }

        .trend-negative {
            color: var(--danger-color);
        }

        .stat-details {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-top: 8px;
        }

        /* شبكة المحتوى */
        .projects-content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 32px;
        }

        /* القسم الأيمن */
        .projects-right-column {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        /* القسم الأيسر */
        .projects-left-column {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        /* البطاقات */
        .project-card {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 8px 32px var(--shadow-color);
            border: 1px solid var(--glass-border);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border-color);
        }

        .card-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title i {
            color: var(--primary-color);
        }

        .card-action {
            font-size: 14px;
            color: var(--primary-color);
            font-weight: 700;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-action:hover {
            transform: translateX(-4px);
        }

        /* مخطط أداء المشاريع */
        .performance-chart-container {
            position: relative;
            height: 300px;
        }

        .chart-placeholder {
            width: 100%;
            height: 100%;
            background: var(--bg-secondary);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 16px;
        }

        /* قائمة المشاريع النشطة */
        .active-projects-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .project-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .project-item:hover {
            background: var(--bg-tertiary);
            transform: translateX(-4px);
            border-color: var(--primary-color);
        }

        .project-avatar {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 20px;
            position: relative;
            flex-shrink: 0;
        }

        .avatar-progress {
            position: absolute;
            bottom: -4px;
            left: -4px;
            right: -4px;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: width var(--transition-slow);
        }

        .project-details {
            flex: 1;
            min-width: 0;
        }

        .project-name {
            font-size: 16px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .project-client {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .project-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .project-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .project-actions {
            display: flex;
            gap: 8px;
        }

        .project-action-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .project-action-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: transparent;
        }

        /* جدول تحليل المشاريع */
        .projects-table-container {
            overflow-x: auto;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            background: var(--glass-bg);
        }

        .projects-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .projects-table thead {
            background: linear-gradient(135deg, 
                rgba(10, 147, 150, 0.1) 0%,
                rgba(238, 155, 0, 0.1) 100%);
        }

        .projects-table th {
            padding: 20px;
            text-align: right;
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border-color);
        }

        .projects-table td {
            padding: 20px;
            text-align: right;
            font-size: 14px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
        }

        .projects-table tbody tr {
            transition: all var(--transition-fast);
        }

        .projects-table tbody tr:hover {
            background: var(--bg-secondary);
        }

        .projects-table tbody tr:last-child td {
            border-bottom: none;
        }

        .project-cell {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .project-cell-avatar {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
        }

        .project-cell-info {
            flex: 1;
            min-width: 0;
        }

        .project-cell-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .project-cell-type {
            font-size: 12px;
            color: var(--text-tertiary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .status-badge-table {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            display: inline-block;
        }

        .status-active {
            background: rgba(42, 157, 143, 0.1);
            color: var(--success-color);
        }

        .status-pending {
            background: rgba(233, 196, 106, 0.1);
            color: var(--warning-color);
        }

        .status-completed {
            background: rgba(10, 147, 150, 0.1);
            color: var(--primary-color);
        }

        .status-delayed {
            background: rgba(231, 111, 81, 0.1);
            color: var(--danger-color);
        }

        .progress-bar-table {
            width: 100%;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill-table {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
            transition: width var(--transition-slow);
        }

        .priority-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            display: inline-block;
        }

        .priority-high {
            background: rgba(231, 111, 81, 0.1);
            color: var(--danger-color);
        }

        .priority-medium {
            background: rgba(233, 196, 106, 0.1);
            color: var(--warning-color);
        }

        .priority-low {
            background: rgba(10, 147, 150, 0.1);
            color: var(--primary-color);
        }

        .action-dropdown {
            position: relative;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .action-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: transparent;
        }

        /* توزيع المشاريع */
        .distribution-chart-container {
            position: relative;
            height: 200px;
            margin-bottom: 20px;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* تحليل الربحية */
        .profitability-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .profitability-stat {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }

        .profitability-stat-value {
            font-size: 20px;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .profitability-stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* الجدول الزمني للمشاريع */
        .timeline-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .timeline-item {
            display: flex;
            gap: 16px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            right: 32px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-marker {
            width: 12px;
            height: 12px;
            background: var(--primary-color);
            border: 2px solid var(--bg-primary);
            border-radius: 50%;
            position: absolute;
            right: 27px;
            top: 20px;
            z-index: 1;
        }

        .timeline-content {
            flex: 1;
            margin-right: 32px;
        }

        .timeline-title {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .timeline-description {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .timeline-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 11px;
            color: var(--text-tertiary);
        }

        /* فريق المشروع */
        .team-members-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .team-member {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }

        .member-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
        }

        .member-info {
            flex: 1;
            min-width: 0;
        }

        .member-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .member-role {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .member-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-available {
            background: var(--success-color);
            animation: pulse 2s infinite;
        }

        .status-busy {
            background: var(--warning-color);
        }

        .status-offline {
            background: var(--text-tertiary);
        }

        /* نافذة تفاصيل المشروع */
        .project-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-medium);
        }

        .project-detail-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .project-detail-container {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            border-radius: 32px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 32px 80px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--glass-border);
            transform: translateY(40px);
            transition: transform var(--transition-medium);
        }

        .project-detail-modal.show .project-detail-container {
            transform: translateY(0);
        }

        .project-detail-header {
            padding: 32px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, 
                rgba(10, 147, 150, 0.1) 0%,
                rgba(238, 155, 0, 0.1) 100%);
        }

        .project-detail-header h2 {
            font-size: 24px;
            font-weight: 900;
            color: var(--text-primary);
            margin: 0;
        }

        .project-detail-close {
            width: 48px;
            height: 48px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .project-detail-close:hover {
            color: var(--danger-color);
            border-color: var(--danger-color);
            transform: rotate(90deg);
        }

        .project-detail-body {
            padding: 32px;
        }

        .project-profile-header {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .project-profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 36px;
            position: relative;
        }

        .project-profile-info h3 {
            font-size: 28px;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .project-profile-info p {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .project-profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .project-profile-stat {
            text-align: center;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }

        .project-profile-stat-value {
            font-size: 24px;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .project-profile-stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* الشريط السفلي */
        .projects-bottom-bar {
            height: 90px;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            border-top: 1px solid var(--glass-border);
            padding: 0 24px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: var(--z-fixed);
            display: flex;
            align-items: center;
            justify-content: space-around;
            box-shadow: 0 -4px 32px var(--shadow-color);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
            flex: 1;
            padding: 12px;
            border-radius: 16px;
            transition: all var(--transition-fast);
            position: relative;
        }

        .nav-item:hover {
            color: var(--primary-color);
            background: rgba(10, 147, 150, 0.1);
        }

        .nav-item.active {
            color: var(--primary-color);
            background: rgba(10, 147, 150, 0.15);
        }

        .nav-icon {
            font-size: 22px;
            position: relative;
        }

        .nav-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: linear-gradient(135deg, var(--danger-color), #d1664b);
            color: white;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            font-weight: 700;
            border: 2px solid var(--bg-primary);
        }

        /* أنيميشن */
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(20px) rotate(240deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes progressAnimation {
            from {
                width: 0;
            }
        }

        /* تأثيرات خاصة للمشاريع */
        .project-glow {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                transparent 0%,
                rgba(255,255,255,0.1) 50%,
                transparent 100%);
            opacity: 0;
            transition: opacity var(--transition-medium);
        }

        .project-stat:hover .project-glow {
            opacity: 1;
        }

        /* تحسينات للأندرويد */
        .android-optimized {
            -webkit-overflow-scrolling: touch;
        }

        .touch-feedback {
            position: relative;
            overflow: hidden;
        }

        .touch-feedback::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: inherit;
            transform: translate(-50%, -50%) scale(0);
            transition: transform 0.3s;
            pointer-events: none;
        }

        .touch-feedback:active::after {
            transform: translate(-50%, -50%) scale(1);
        }

        /* تحسينات الجدول للأندرويد */
        .table-scroll-wrapper {
            -webkit-overflow-scrolling: touch;
            overflow-x: auto;
        }

        /* التجاوب */
        @media (max-width: 1200px) {
            .projects-content-grid {
                grid-template-columns: 1fr;
            }
            
            .projects-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .project-profile-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            html {
                font-size: 14px;
            }
            
            .main-header {
                height: 70px;
                padding: 0 16px;
            }
            
            .main-content {
                padding: 114px 0 160px;
            }
            
            .projects-container {
                padding: 0 16px;
            }
            
            .projects-overview-header {
                padding: 24px;
            }
            
            .overview-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-group {
                width: 100%;
            }
            
            .control-select {
                flex: 1;
            }
            
            .projects-stats-grid {
                grid-template-columns: 1fr;
                padding: 24px;
                gap: 16px;
            }
            
            .stat-value {
                font-size: 28px;
            }
            
            .projects-table th,
            .projects-table td {
                padding: 12px;
            }
            
            .profitability-stats {
                grid-template-columns: 1fr;
            }
            
            .projects-bottom-bar {
                height: 80px;
                padding: 0 16px;
            }
        }

        @media (max-width: 480px) {
            .header-title {
                font-size: 18px;
            }
            
            .overview-title {
                font-size: 22px;
            }
            
            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .project-item {
                padding: 16px;
            }
            
            .project-actions {
                flex-direction: column;
            }
            
            .chart-legend {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .project-detail-header {
                padding: 24px;
            }
            
            .project-detail-body {
                padding: 24px;
            }
            
            .project-profile-header {
                flex-direction: column;
                text-align: center;
            }
        }

        /* دعم Safe Areas للأجهزة الحديثة */
        @supports (padding: max(0px)) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }
            
            .smart-status-bar {
                height: calc(44px + env(safe-area-inset-top));
                padding-top: env(safe-area-inset-top);
            }
            
            .main-header {
                top: calc(44px + env(safe-area-inset-top));
            }
            
            .main-content {
                padding-top: calc(124px + env(safe-area-inset-top));
            }
            
            .projects-bottom-bar {
                height: calc(90px + env(safe-area-inset-bottom));
                padding-bottom: env(safe-area-inset-bottom);
            }
        }

        /* تحسينات الأداء */
        .performance-optimized {
            will-change: transform, opacity;
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }

        /* تحسينات اللمس */
        @media (hover: none) and (pointer: coarse) {
            .project-stat:hover,
            .project-item:hover,
            .projects-table tbody tr:hover {
                transform: none;
            }
            
            .touch-feedback:active::after {
                transform: translate(-50%, -50%) scale(1);
            }
            
            .action-btn:hover,
            .project-action-btn:hover {
                background: var(--bg-tertiary);
                color: var(--text-secondary);
                border-color: var(--border-color);
            }
        }

        /* شريط التمرير المخصص */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
    </style>
</head>
<body class="android-optimized">
    <!-- الخلفية الديناميكية -->
    <div class="dynamic-background">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <!-- شريط الحالة الذكي -->
    <div class="smart-status-bar">
        <div class="status-content">
            <span id="currentTime">--:--</span>
            <div class="status-badge">
                <i class="fas fa-wifi"></i>
                <span>5G</span>
            </div>
            <div class="status-badge">
                <i class="fas fa-battery-three-quarters"></i>
                <span>85%</span>
            </div>
        </div>
        <div class="status-content">
            <div class="status-badge">
                <i class="fas fa-project-diagram"></i>
                <span>تحليل المشاريع</span>
            </div>
        </div>
    </div>

    <!-- الهيدر الرئيسي -->
    <header class="main-header">
        <div class="header-left">
            <a href="javascript:history.back()" class="header-back">
                <i class="fas fa-arrow-right"></i>
                <span>رجوع</span>
            </a>
            <h1 class="header-title">إحصائيات المشاريع</h1>
        </div>

        <div class="header-right">
            <div class="header-action" onclick="toggleDarkMode()" id="darkModeToggle">
                <i class="fas fa-moon"></i>
            </div>
            <div class="header-action" onclick="projectsStatsSystem.exportReport()">
                <i class="fas fa-file-export"></i>
            </div>
            <div class="header-action" onclick="projectsStatsSystem.createProject()">
                <i class="fas fa-plus"></i>
            </div>
        </div>
    </header>

    <!-- المحتوى الرئيسي -->
    <main class="main-content">
        <div class="projects-container">
            <!-- بطاقة نظرة عامة على المشاريع -->
            <div class="projects-overview-card">
                <div class="projects-overview-header">
                    <h2 class="overview-title">نظرة عامة على المشاريع</h2>
                    <p class="overview-subtitle">تحليل شامل لأداء المشاريع ومؤشرات الأداء</p>
                    
                    <div class="overview-controls">
                        <div class="control-group">
                            <span class="control-label">الفترة:</span>
                            <select class="control-select" id="periodFilter" onchange="projectsStatsSystem.filterByPeriod()">
                                <option value="week">هذا الأسبوع</option>
                                <option value="month" selected>هذا الشهر</option>
                                <option value="quarter">هذا الربع</option>
                                <option value="year">هذه السنة</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <span class="control-label">القسم:</span>
                            <select class="control-select" id="departmentFilter" onchange="projectsStatsSystem.filterByDepartment()">
                                <option value="all">جميع الأقسام</option>
                                <option value="design">التصميم</option>
                                <option value="development">التطوير</option>
                                <option value="marketing">التسويق</option>
                                <option value="consulting">الاستشارات</option>
                            </select>
                        </div>
                        
                        <button class="control-btn touch-feedback" onclick="projectsStatsSystem.refreshData()">
                            <i class="fas fa-sync-alt"></i>
                            تحديث البيانات
                        </button>
                    </div>
                </div>
                
                <!-- إحصائيات المشاريع -->
                <div class="projects-stats-grid">
                    <div class="project-stat touch-feedback" onclick="projectsStatsSystem.viewAllProjects()">
                        <div class="project-glow"></div>
                        <div class="stat-header">
                            <div class="stat-info">
                                <h3>إجمالي المشاريع</h3>
                                <div class="stat-value" id="totalProjects">42</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-folder-open"></i>
                            </div>
                        </div>
                        <div class="stat-trend trend-positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+5 هذا الشهر</span>
                        </div>
                        <div class="stat-details">24 نشطة • 12 مكتملة • 6 معلقة</div>
                    </div>
                    
                    <div class="project-stat touch-feedback" onclick="projectsStatsSystem.viewActiveProjects()">
                        <div class="project-glow"></div>
                        <div class="stat-header">
                            <div class="stat-info">
                                <h3>المشاريع النشطة</h3>
                                <div class="stat-value" id="activeProjects">24</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-play-circle"></i>
                            </div>
                        </div>
                        <div class="stat-trend trend-positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+3 هذا الأسبوع</span>
                        </div>
                        <div class="stat-details">65% في الموعد • 85% التقدم</div>
                    </div>
                    
                    <div class="project-stat touch-feedback" onclick="projectsStatsSystem.viewRevenue()">
                        <div class="project-glow"></div>
                        <div class="stat-header">
                            <div class="stat-info">
                                <h3>إيرادات المشاريع</h3>
                                <div class="stat-value" id="projectsRevenue">245K</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                        </div>
                        <div class="stat-trend trend-positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+18% عن الشهر</span>
                        </div>
                        <div class="stat-details">متوسط المشروع: 5,830 ريال</div>
                    </div>
                    
                    <div class="project-stat touch-feedback" onclick="projectsStatsSystem.viewEfficiency()">
                        <div class="project-glow"></div>
                        <div class="stat-header">
                            <div class="stat-info">
                                <h3>كفاءة التنفيذ</h3>
                                <div class="stat-value" id="efficiencyRate">92%</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                        </div>
                        <div class="stat-trend trend-positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+5% عن الربع</span>
                        </div>
                        <div class="stat-details">معدل التسليم في الوقت</div>
                    </div>
                </div>
            </div>

            <!-- شبكة محتوى المشاريع -->
            <div class="projects-content-grid">
                <!-- القسم الأيسر -->
                <div class="projects-left-column">
                    <!-- أداء المشاريع -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-line"></i>
                                أداء المشاريع
                            </div>
                            <div class="card-action" onclick="projectsStatsSystem.viewPerformanceDetails()">
                                <i class="fas fa-expand-alt"></i>
                                عرض موسع
                            </div>
                        </div>
                        
                        <div class="performance-chart-container">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>

                    <!-- المشاريع النشطة -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-bolt"></i>
                                المشاريع النشطة حالياً
                            </div>
                            <div class="card-action" onclick="projectsStatsSystem.viewAllActiveProjects()">
                                <i class="fas fa-arrow-left"></i>
                                عرض الكل
                            </div>
                        </div>
                        
                        <div class="active-projects-list" id="activeProjectsList">
                            <!-- سيتم إضافة المشاريع ديناميكياً -->
                        </div>
                    </div>

                    <!-- الجدول الزمني -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-alt"></i>
                                الجدول الزمني
                            </div>
                            <div class="card-action" onclick="projectsStatsSystem.viewTimeline()">
                                <i class="fas fa-clock"></i>
                                عرض كامل
                            </div>
                        </div>
                        
                        <div class="timeline-container" id="timelineContainer">
                            <!-- سيتم إضافة الجدول الزمني ديناميكياً -->
                        </div>
                    </div>
                </div>

                <!-- القسم الأيمن -->
                <div class="projects-right-column">
                    <!-- جدول تحليل المشاريع -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-table"></i>
                                تحليل المشاريع
                            </div>
                            <div class="card-action" onclick="projectsStatsSystem.exportTable()">
                                <i class="fas fa-download"></i>
                                تصدير
                            </div>
                        </div>
                        
                        <div class="projects-table-container table-scroll-wrapper">
                            <table class="projects-table">
                                <thead>
                                    <tr>
                                        <th>المشروع</th>
                                        <th>الحالة</th>
                                        <th>التقدم</th>
                                        <th>الأولوية</th>
                                        <th>القيمة</th>
                                        <th>الأفعال</th>
                                    </tr>
                                </thead>
                                <tbody id="projectsTableBody">
                                    <!-- سيتم إضافة الصفوف ديناميكياً -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- توزيع المشاريع -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-pie"></i>
                                توزيع المشاريع
                            </div>
                        </div>
                        
                        <div class="distribution-chart-container">
                            <canvas id="distributionChart"></canvas>
                        </div>
                        
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--primary-color);"></div>
                                <span>التصميم (35%)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--secondary-color);"></div>
                                <span>التطوير (28%)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--accent-color);"></div>
                                <span>التسويق (22%)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--success-color);"></div>
                                <span>استشارات (15%)</span>
                            </div>
                        </div>
                    </div>

                    <!-- فريق المشروع -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-users"></i>
                                فريق المشروع
                            </div>
                            <div class="card-action" onclick="projectsStatsSystem.viewTeam()">
                                <i class="fas fa-user-plus"></i>
                                إضافة
                            </div>
                        </div>
                        
                        <div class="team-members-list" id="teamMembersList">
                            <!-- سيتم إضافة أعضاء الفريق ديناميكياً -->
                        </div>
                    </div>

                    <!-- تحليل الربحية -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-bar"></i>
                                تحليل الربحية
                            </div>
                        </div>
                        
                        <div class="profitability-stats" id="profitabilityStats">
                            <!-- سيتم إضافة إحصائيات الربحية ديناميكياً -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- نافذة تفاصيل المشروع -->
    <div class="project-detail-modal" id="projectDetailModal">
        <div class="project-detail-container">
            <div class="project-detail-header">
                <h2 id="projectDetailTitle">تفاصيل المشروع</h2>
                <button class="project-detail-close" onclick="projectsStatsSystem.closeProjectDetail()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="project-detail-body" id="projectDetailBody">
                <!-- سيتم إضافة محتوى النافذة ديناميكياً -->
            </div>
        </div>
    </div>

    <!-- الشريط السفلي -->
    <nav class="projects-bottom-bar">
        <a href="dashboard-designer.html" class="nav-item">
            <div class="nav-icon">
                <i class="fas fa-home"></i>
            </div>
            <span>الرئيسية</span>
        </a>
        
        <a href="jobs.html" class="nav-item">
            <div class="nav-icon">
                <i class="fas fa-briefcase"></i>
            </div>
            <span>الوظائف</span>
        </a>
        
        <a href="messages.html" class="nav-item">
            <div class="nav-icon">
                <i class="fas fa-comments"></i>
                <span class="nav-badge">8</span>
            </div>
            <span>الرسائل</span>
        </a>
        
        <a href="projects-stats.html" class="nav-item active">
            <div class="nav-icon">
                <i class="fas fa-project-diagram"></i>
            </div>
            <span>المشاريع</span>
        </a>
        
        <a href="profile.html" class="nav-item">
            <div class="nav-icon">
                <i class="fas fa-user"></i>
            </div>
            <span>حسابي</span>
        </a>
    </nav>

    <!-- نظام إحصائيات المشاريع المتقدم -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // نظام إحصائيات المشاريع
        class ProjectsStatsSystem {
            constructor() {
                this.projectsData = null;
                this.performanceChart = null;
                this.distributionChart = null;
                this.currentFilter = {
                    period: 'month',
                    department: 'all'
                };
                this.selectedProject = null;
                this.init();
            }

            async init() {
                await this.loadProjectsData();
                this.setupEventListeners();
                this.renderDashboard();
                this.initPerformanceChart();
                this.initDistributionChart();
                this.updateTime();
                this.setupTouchGestures();
                this.showWelcomeMessage();
                
                // تحديث التوقيت
                setInterval(() => this.updateRealTimeData(), 30000);
            }

            async loadProjectsData() {
                // تحميل بيانات المشاريع من localStorage أو API
                const savedData = localStorage.getItem('projectsStatsData');
                
                if (savedData) {
                    this.projectsData = JSON.parse(savedData);
                } else {
                    // بيانات افتراضية شاملة
                    this.projectsData = {
                        summary: {
                            totalProjects: 42,
                            activeProjects: 24,
                            completedProjects: 12,
                            pendingProjects: 6,
                            revenue: 245000,
                            efficiency: 92,
                            avgProjectValue: 5830,
                            onTimeDelivery: 85
                        },
                        activeProjects: [
                            {
                                id: 1,
                                name: "تطبيق البنك الذكي",
                                client: "بنك المستقبل",
                                progress: 85,
                                status: "active",
                                priority: "high",
                                value: 25000,
                                deadline: "2024-03-15",
                                team: 3,
                                color: "linear-gradient(135deg, #0a9396, #005f73)"
                            },
                            {
                                id: 2,
                                name: "منصة التعليم الإلكتروني",
                                client: "أكاديمية المستقبل",
                                progress: 65,
                                status: "active",
                                priority: "medium",
                                value: 18000,
                                deadline: "2024-03-25",
                                team: 5,
                                color: "linear-gradient(135deg, #ee9b00, #ca6702)"
                            },
                            {
                                id: 3,
                                name: "هوية بصرية جديدة",
                                client: "مجموعة الرفاهية",
                                progress: 45,
                                status: "active",
                                priority: "low",
                                value: 12000,
                                deadline: "2024-04-05",
                                team: 2,
                                color: "linear-gradient(135deg, #9b5de5, #7209b7)"
                            },
                            {
                                id: 4,
                                name: "تطبيق توصيل الطعام",
                                client: "مطاعم الذواقة",
                                progress: 90,
                                status: "active",
                                priority: "high",
                                value: 30000,
                                deadline: "2024-03-10",
                                team: 4,
                                color: "linear-gradient(135deg, #2a9d8f, #21867a)"
                            },
                            {
                                id: 5,
                                name: "موقع تجارة إلكترونية",
                                client: "شركة النقل السريع",
                                progress: 30,
                                status: "active",
                                priority: "medium",
                                value: 15000,
                                deadline: "2024-04-20",
                                team: 3,
                                color: "linear-gradient(135deg, #e76f51, #d1664b)"
                            }
                        ],
                        projectsTable: [
                            {
                                id: 1,
                                name: "تطبيق البنك الذكي",
                                type: "تطبيق موبايل",
                                status: "active",
                                progress: 85,
                                priority: "high",
                                value: 25000,
                                client: "بنك المستقبل",
                                startDate: "2024-01-15",
                                deadline: "2024-03-15",
                                teamSize: 3,
                                department: "development",
                                color: "#0a9396"
                            },
                            {
                                id: 2,
                                name: "منصة التعليم الإلكتروني",
                                type: "موقع ويب",
                                status: "active",
                                progress: 65,
                                priority: "medium",
                                value: 18000,
                                client: "أكاديمية المستقبل",
                                startDate: "2024-02-01",
                                deadline: "2024-03-25",
                                teamSize: 5,
                                department: "development",
                                color: "#ee9b00"
                            },
                            {
                                id: 3,
                                name: "هوية بصرية جديدة",
                                type: "تصميم جرافيك",
                                status: "active",
                                progress: 45,
                                priority: "low",
                                value: 12000,
                                client: "مجموعة الرفاهية",
                                startDate: "2024-02-15",
                                deadline: "2024-04-05",
                                teamSize: 2,
                                department: "design",
                                color: "#9b5de5"
                            },
                            {
                                id: 4,
                                name: "تطبيق توصيل الطعام",
                                type: "تطبيق موبايل",
                                status: "completed",
                                progress: 100,
                                priority: "high",
                                value: 30000,
                                client: "مطاعم الذواقة",
                                startDate: "2023-12-01",
                                deadline: "2024-02-28",
                                teamSize: 4,
                                department: "development",
                                color: "#2a9d8f"
                            },
                            {
                                id: 5,
                                name: "موقع تجارة إلكترونية",
                                type: "موقع ويب",
                                status: "active",
                                progress: 30,
                                priority: "medium",
                                value: 15000,
                                client: "شركة النقل السريع",
                                startDate: "2024-02-20",
                                deadline: "2024-04-20",
                                teamSize: 3,
                                department: "development",
                                color: "#e76f51"
                            },
                            {
                                id: 6,
                                name: "حملة تسويقية رقمية",
                                type: "تسويق رقمي",
                                status: "pending",
                                progress: 0,
                                priority: "medium",
                                value: 8000,
                                client: "وكالة سفر وسياحة",
                                startDate: "2024-03-10",
                                deadline: "2024-04-10",
                                teamSize: 2,
                                department: "marketing",
                                color: "#4cc9f0"
                            },
                            {
                                id: 7,
                                name: "استشارة إستراتيجية",
                                type: "استشارات",
                                status: "active",
                                progress: 70,
                                priority: "low",
                                value: 10000,
                                client: "مستشفى التميز",
                                startDate: "2024-01-30",
                                deadline: "2024-03-30",
                                teamSize: 1,
                                department: "consulting",
                                color: "#ff6b6b"
                            },
                            {
                                id: 8,
                                name: "تصميم شعار وبراند",
                                type: "تصميم جرافيك",
                                status: "delayed",
                                progress: 95,
                                priority: "high",
                                value: 6000,
                                client: "شركة ناشئة",
                                startDate: "2024-01-10",
                                deadline: "2024-02-10",
                                teamSize: 1,
                                department: "design",
                                color: "#ffd166"
                            }
                        ],
                        timeline: [
                            {
                                id: 1,
                                title: "تسليم مشروع تطبيق البنك",
                                description: "مرحلة التطوير النهائية واختبارات الجودة",
                                date: "2024-03-15",
                                time: "10:00 ص",
                                status: "upcoming",
                                projectId: 1
                            },
                            {
                                id: 2,
                                title: "اجتماع مراجعة منصة التعليم",
                                description: "عرض التقدم والمناقشة مع العميل",
                                date: "2024-03-05",
                                time: "02:00 م",
                                status: "today",
                                projectId: 2
                            },
                            {
                                id: 3,
                                title: "تسليم الهوية البصرية",
                                description: "عرض النسخة النهائية للهوية",
                                date: "2024-03-01",
                                time: "11:00 ص",
                                status: "completed",
                                projectId: 3
                            },
                            {
                                id: 4,
                                title: "بدء حملة تسويقية جديدة",
                                description: "انطلاق الحملة الرقمية للعميل",
                                date: "2024-03-10",
                                time: "09:00 ص",
                                status: "upcoming",
                                projectId: 6
                            }
                        ],
                        teamMembers: [
                            {
                                id: 1,
                                name: "أحمد محمد",
                                role: "مدير مشروع",
                                status: "available",
                                projects: 5,
                                color: "#0a9396"
                            },
                            {
                                id: 2,
                                name: "سارة أحمد",
                                role: "مصمم UI/UX",
                                status: "busy",
                                projects: 3,
                                color: "#ee9b00"
                            },
                            {
                                id: 3,
                                name: "محمد الخالد",
                                role: "مطور ويب",
                                status: "available",
                                projects: 4,
                                color: "#9b5de5"
                            },
                            {
                                id: 4,
                                name: "نورة السعيد",
                                role: "متخصصة تسويق",
                                status: "offline",
                                projects: 2,
                                color: "#2a9d8f"
                            },
                            {
                                id: 5,
                                name: "خالد فهد",
                                role: "مطور تطبيقات",
                                status: "available",
                                projects: 3,
                                color: "#e76f51"
                            }
                        ],
                        profitability: [
                            { label: "هامش الربح", value: "42%", change: "+5%" },
                            { label: "العائد على الاستثمار", value: "185%", change: "+12%" },
                            { label: "تكلفة المشروع", value: "12.4K", change: "-3%" },
                            { label: "ربحية العميل", value: "8.2K", change: "+8%" }
                        ],
                        performance: {
                            labels: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو', 'يوليو'],
                            completed: [8, 10, 12, 9, 11, 13, 15],
                            active: [18, 20, 22, 24, 23, 25, 24],
                            revenue: [180000, 195000, 210000, 225000, 235000, 240000, 245000]
                        },
                        distribution: {
                            design: 35,
                            development: 28,
                            marketing: 22,
                            consulting: 15
                        }
                    };
                    
                    localStorage.setItem('projectsStatsData', JSON.stringify(this.projectsData));
                }
            }

            setupEventListeners() {
                // تحديث الوقت كل دقيقة
                setInterval(() => this.updateTime(), 60000);
                
                // تحديث البيانات في الوقت الفعلي
                setInterval(() => this.simulateRealTimeUpdate(), 20000);
                
                // السحب للتحديث
                this.setupPullToRefresh();
            }

            setupPullToRefresh() {
                let touchStartY = 0;
                let touchEndY = 0;

                document.addEventListener('touchstart', e => {
                    touchStartY = e.changedTouches[0].screenY;
                }, { passive: true });

                document.addEventListener('touchend', e => {
                    touchEndY = e.changedTouches[0].screenY;
                    this.handlePullToRefresh(touchStartY, touchEndY);
                }, { passive: true });
            }

            handlePullToRefresh(startY, endY) {
                const pullDistance = endY - startY;
                
                if (pullDistance > 100 && window.scrollY === 0) {
                    this.showToast('جاري تحديث بيانات المشاريع...', 'info');
                    setTimeout(() => {
                        this.refreshData();
                        this.showToast('تم تحديث البيانات بنجاح', 'success');
                    }, 1000);
                }
            }

            setupTouchGestures() {
                // إضافة تأثيرات اللمس للعناصر
                document.querySelectorAll('.touch-feedback').forEach(element => {
                    element.addEventListener('touchstart', function() {
                        this.classList.add('active');
                    }, { passive: true });
                    
                    element.addEventListener('touchend', function() {
                        this.classList.remove('active');
                    }, { passive: true });
                });
            }

            renderDashboard() {
                this.renderSummaryStats();
                this.renderActiveProjects();
                this.renderProjectsTable();
                this.renderTimeline();
                this.renderTeamMembers();
                this.renderProfitabilityStats();
            }

            renderSummaryStats() {
                document.getElementById('totalProjects').textContent = 
                    this.projectsData.summary.totalProjects;
                document.getElementById('activeProjects').textContent = 
                    this.projectsData.summary.activeProjects;
                document.getElementById('projectsRevenue').textContent = 
                    this.formatNumber(this.projectsData.summary.revenue);
                document.getElementById('efficiencyRate').textContent = 
                    this.projectsData.summary.efficiency + '%';
            }

            renderActiveProjects() {
                const container = document.getElementById('activeProjectsList');
                container.innerHTML = this.projectsData.activeProjects.map(project => `
                    <div class="project-item touch-feedback" onclick="projectsStatsSystem.showProjectDetail(${project.id})">
                        <div class="project-avatar" style="background: ${project.color};">
                            <span>${project.name.charAt(0)}</span>
                            <div class="avatar-progress">
                                <div class="progress-fill" style="width: ${project.progress}%"></div>
                            </div>
                        </div>
                        <div class="project-details">
                            <div class="project-name">${project.name}</div>
                            <div class="project-client">${project.client}</div>
                            <div class="project-meta">
                                <div class="project-meta-item">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>${this.formatDate(project.deadline)}</span>
                                </div>
                                <div class="project-meta-item">
                                    <i class="fas fa-users"></i>
                                    <span>${project.team} أعضاء</span>
                                </div>
                            </div>
                        </div>
                        <div class="project-actions">
                            <button class="project-action-btn" onclick="projectsStatsSystem.updateProgress(${project.id}, event)">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="project-action-btn" onclick="projectsStatsSystem.messageTeam(${project.id}, event)">
                                <i class="fas fa-comment"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            renderProjectsTable() {
                const container = document.getElementById('projectsTableBody');
                container.innerHTML = this.projectsData.projectsTable.map(project => {
                    const statusClass = `status-${project.status}`;
                    const statusText = this.getStatusText(project.status);
                    const priorityClass = `priority-${project.priority}`;
                    const priorityText = this.getPriorityText(project.priority);
                    
                    return `
                        <tr onclick="projectsStatsSystem.showProjectDetail(${project.id})" style="cursor: pointer;">
                            <td>
                                <div class="project-cell">
                                    <div class="project-cell-avatar" style="background: ${project.color};">
                                        ${project.name.charAt(0)}
                                    </div>
                                    <div class="project-cell-info">
                                        <div class="project-cell-name">${project.name}</div>
                                        <div class="project-cell-type">${project.type}</div>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="status-badge-table ${statusClass}">
                                    ${statusText}
                                </span>
                            </td>
                            <td>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 12px; font-weight: 700; min-width: 30px;">${project.progress}%</span>
                                    <div class="progress-bar-table">
                                        <div class="progress-fill-table" style="width: ${project.progress}%"></div>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="priority-badge ${priorityClass}">
                                    ${priorityText}
                                </span>
                            </td>
                            <td style="font-weight: 700;">${this.formatNumber(project.value)} ريال</td>
                            <td>
                                <div class="action-dropdown">
                                    <button class="action-btn" onclick="projectsStatsSystem.showProjectActions(${project.id}, event)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');
            }

            renderTimeline() {
                const container = document.getElementById('timelineContainer');
                container.innerHTML = this.projectsData.timeline.map(item => {
                    const statusClass = this.getTimelineStatusClass(item.status);
                    const statusText = this.getTimelineStatusText(item.status);
                    
                    return `
                        <div class="timeline-item">
                            <div class="timeline-marker ${statusClass}"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">${item.title}</div>
                                <div class="timeline-description">${item.description}</div>
                                <div class="timeline-meta">
                                    <span><i class="far fa-calendar"></i> ${this.formatDate(item.date)}</span>
                                    <span>•</span>
                                    <span><i class="far fa-clock"></i> ${item.time}</span>
                                    <span>•</span>
                                    <span class="${statusClass}">${statusText}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            renderTeamMembers() {
                const container = document.getElementById('teamMembersList');
                container.innerHTML = this.projectsData.teamMembers.map(member => `
                    <div class="team-member">
                        <div class="member-avatar" style="background: ${member.color};">
                            ${member.name.charAt(0)}
                        </div>
                        <div class="member-info">
                            <div class="member-name">${member.name}</div>
                            <div class="member-role">${member.role} • ${member.projects} مشاريع</div>
                        </div>
                        <div class="member-status status-${member.status}"></div>
                    </div>
                `).join('');
            }

            renderProfitabilityStats() {
                const container = document.getElementById('profitabilityStats');
                container.innerHTML = this.projectsData.profitability.map(stat => `
                    <div class="profitability-stat">
                        <div class="profitability-stat-value">${stat.value}</div>
                        <div class="profitability-stat-label">${stat.label}</div>
                        ${stat.change ? `
                            <div style="font-size: 10px; color: ${stat.change.startsWith('+') ? 'var(--success-color)' : 'var(--danger-color)'}; margin-top: 4px;">
                                ${stat.change}
                            </div>
                        ` : ''}
                    </div>
                `).join('');
            }

            getStatusText(status) {
                const statusMap = {
                    'active': 'نشط',
                    'completed': 'مكتمل',
                    'pending': 'قيد الانتظار',
                    'delayed': 'متأخر'
                };
                return statusMap[status] || status;
            }

            getPriorityText(priority) {
                const priorityMap = {
                    'high': 'عالي',
                    'medium': 'متوسط',
                    'low': 'منخفض'
                };
                return priorityMap[priority] || priority;
            }

            getTimelineStatusClass(status) {
                const classMap = {
                    'completed': 'trend-positive',
                    'today': 'trend-positive',
                    'upcoming': ''
                };
                return classMap[status] || '';
            }

            getTimelineStatusText(status) {
                const textMap = {
                    'completed': 'مكتمل',
                    'today': 'اليوم',
                    'upcoming': 'قادم'
                };
                return textMap[status] || status;
            }

            formatNumber(num) {
                if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return num.toString();
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ar-SA');
            }

            initPerformanceChart() {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                
                if (this.performanceChart) {
                    this.performanceChart.destroy();
                }
                
                const data = {
                    labels: this.projectsData.performance.labels,
                    datasets: [
                        {
                            label: 'مشاريع مكتملة',
                            data: this.projectsData.performance.completed,
                            backgroundColor: 'rgba(10, 147, 150, 0.2)',
                            borderColor: 'rgba(10, 147, 150, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'مشاريع نشطة',
                            data: this.projectsData.performance.active,
                            backgroundColor: 'rgba(238, 155, 0, 0.2)',
                            borderColor: 'rgba(238, 155, 0, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }
                    ]
                };
                
                this.performanceChart = new Chart(ctx, {
                    type: 'line',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                rtl: true,
                                labels: {
                                    font: {
                                        family: 'Cairo'
                                    },
                                    color: 'var(--text-primary)'
                                }
                            },
                            tooltip: {
                                rtl: true,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        label += context.parsed.y;
                                        return label;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: 'var(--text-secondary)',
                                    font: {
                                        family: 'Cairo'
                                    }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                ticks: {
                                    color: 'var(--text-secondary)',
                                    font: {
                                        family: 'Cairo'
                                    }
                                }
                            }
                        }
                    }
                });
            }

            initDistributionChart() {
                const ctx = document.getElementById('distributionChart').getContext('2d');
                
                if (this.distributionChart) {
                    this.distributionChart.destroy();
                }
                
                const data = {
                    labels: ['التصميم', 'التطوير', 'التسويق', 'الاستشارات'],
                    datasets: [{
                        data: [
                            this.projectsData.distribution.design,
                            this.projectsData.distribution.development,
                            this.projectsData.distribution.marketing,
                            this.projectsData.distribution.consulting
                        ],
                        backgroundColor: [
                            'rgba(10, 147, 150, 0.8)',
                            'rgba(238, 155, 0, 0.8)',
                            'rgba(155, 93, 229, 0.8)',
                            'rgba(42, 157, 143, 0.8)'
                        ],
                        borderColor: [
                            'rgba(10, 147, 150, 1)',
                            'rgba(238, 155, 0, 1)',
                            'rgba(155, 93, 229, 1)',
                            'rgba(42, 157, 143, 1)'
                        ],
                        borderWidth: 2
                    }]
                };
                
                this.distributionChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                rtl: true,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.parsed}%`;
                                    }
                                }
                            }
                        },
                        cutout: '70%'
                    }
                });
            }

            filterByPeriod() {
                const period = document.getElementById('periodFilter').value;
                this.currentFilter.period = period;
                this.showToast(`تم تصفية البيانات حسب: ${this.getPeriodText(period)}`, 'info');
                this.simulateFilteredData();
            }

            filterByDepartment() {
                const department = document.getElementById('departmentFilter').value;
                this.currentFilter.department = department;
                this.showToast(`تم تصفية المشاريع حسب: ${this.getDepartmentText(department)}`, 'info');
                this.simulateFilteredData();
            }

            getPeriodText(period) {
                const periods = {
                    'week': 'هذا الأسبوع',
                    'month': 'هذا الشهر',
                    'quarter': 'هذا الربع',
                    'year': 'هذه السنة'
                };
                return periods[period] || period;
            }

            getDepartmentText(department) {
                const departments = {
                    'all': 'جميع الأقسام',
                    'design': 'التصميم',
                    'development': 'التطوير',
                    'marketing': 'التسويق',
                    'consulting': 'الاستشارات'
                };
                return departments[department] || department;
            }

            refreshData() {
                this.showToast('جاري تحديث بيانات المشاريع...', 'info');
                
                setTimeout(() => {
                    // محاكاة تحديث البيانات
                    this.projectsData.summary.activeProjects += Math.floor(Math.random() * 2);
                    this.projectsData.summary.revenue += Math.floor(Math.random() * 5000);
                    this.projectsData.summary.efficiency += Math.floor(Math.random() * 2);
                    
                    // تحديث تقدم المشاريع عشوائياً
                    this.projectsData.activeProjects.forEach(project => {
                        if (project.progress < 100) {
                            project.progress += Math.floor(Math.random() * 5);
                            if (project.progress > 100) project.progress = 100;
                        }
                    });
                    
                    this.renderDashboard();
                    this.initPerformanceChart();
                    
                    this.showToast('تم تحديث بيانات المشاريع بنجاح', 'success');
                }, 1500);
            }

            simulateFilteredData() {
                // محاكاة بيانات مفلترة حسب القسم
                if (this.currentFilter.department !== 'all') {
                    const filteredProjects = this.projectsData.projectsTable.filter(
                        project => project.department === this.currentFilter.department
                    );
                    
                    // تحديث الإحصائيات المؤقتة
                    const filteredStats = {
                        total: filteredProjects.length,
                        active: filteredProjects.filter(p => p.status === 'active').length,
                        revenue: filteredProjects.reduce((sum, p) => sum + p.value, 0)
                    };
                    
                    document.getElementById('totalProjects').textContent = filteredStats.total;
                    document.getElementById('activeProjects').textContent = filteredStats.active;
                    document.getElementById('projectsRevenue').textContent = this.formatNumber(filteredStats.revenue);
                } else {
                    // إعادة عرض البيانات الأصلية
                    this.renderSummaryStats();
                }
            }

            showProjectDetail(projectId) {
                const project = this.projectsData.projectsTable.find(p => p.id === projectId) ||
                             this.projectsData.activeProjects.find(p => p.id === projectId);
                
                if (!project) return;
                
                this.selectedProject = project;
                
                const modal = document.getElementById('projectDetailModal');
                const title = document.getElementById('projectDetailTitle');
                const body = document.getElementById('projectDetailBody');
                
                title.textContent = `تفاصيل المشروع: ${project.name}`;
                
                // حساب الإحصائيات الإضافية
                const daysRemaining = Math.floor((new Date(project.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                const daysPassed = Math.floor((new Date() - new Date(project.startDate)) / (1000 * 60 * 60 * 24));
                const totalDays = daysPassed + Math.max(daysRemaining, 0);
                const progressPerDay = totalDays > 0 ? (project.progress / totalDays).toFixed(1) : 0;
                
                body.innerHTML = `
                    <div class="project-profile-header">
                        <div class="project-profile-avatar" style="background: ${project.color};">
                            ${project.name.charAt(0)}
                        </div>
                        <div class="project-profile-info">
                            <h3>${project.name}</h3>
                            <p>العميل: ${project.client}</p>
                            <p>النوع: ${project.type}</p>
                            <p>القسم: ${this.getDepartmentText(project.department)}</p>
                        </div>
                    </div>
                    
                    <div class="project-profile-stats">
                        <div class="project-profile-stat">
                            <div class="project-profile-stat-value">${project.progress}%</div>
                            <div class="project-profile-stat-label">التقدم</div>
                        </div>
                        <div class="project-profile-stat">
                            <div class="project-profile-stat-value">${this.formatNumber(project.value)}</div>
                            <div class="project-profile-stat-label">القيمة</div>
                        </div>
                        <div class="project-profile-stat">
                            <div class="project-profile-stat-value">${project.teamSize || project.team || 1}</div>
                            <div class="project-profile-stat-label">أعضاء الفريق</div>
                        </div>
                        <div class="project-profile-stat">
                            <div class="project-profile-stat-value">${daysRemaining > 0 ? daysRemaining : 0}</div>
                            <div class="project-profile-stat-label">أيام متبقية</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 32px;">
                        <h4 style="font-size: 18px; margin-bottom: 16px; color: var(--text-primary);">معلومات المشروع</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
                            <div style="background: var(--bg-secondary); padding: 16px; border-radius: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">تاريخ البدء</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--text-primary);">
                                    ${this.formatDate(project.startDate)}
                                </div>
                            </div>
                            <div style="background: var(--bg-secondary); padding: 16px; border-radius: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">تاريخ الانتهاء</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--text-primary);">
                                    ${this.formatDate(project.deadline)}
                                </div>
                            </div>
                            <div style="background: var(--bg-secondary); padding: 16px; border-radius: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">معدل التقدم اليومي</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--text-primary);">
                                    ${progressPerDay}%
                                </div>
                            </div>
                            <div style="background: var(--bg-secondary); padding: 16px; border-radius: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">الحالة</div>
                                <div style="font-size: 16px; font-weight: 700; color: ${project.status === 'active' ? 'var(--success-color)' : project.status === 'delayed' ? 'var(--danger-color)' : 'var(--text-primary)'};">
                                    ${this.getStatusText(project.status)}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 32px; display: flex; gap: 16px;">
                        <button onclick="projectsStatsSystem.updateProgress(${project.id})" 
                                style="flex: 1; padding: 16px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
                                       color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer;">
                            <i class="fas fa-edit"></i> تحديث التقدم
                        </button>
                        <button onclick="projectsStatsSystem.addTeamMember(${project.id})" 
                                style="flex: 1; padding: 16px; background: var(--bg-secondary); 
                                       color: var(--text-primary); border: 1px solid var(--border-color); 
                                       border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer;">
                            <i class="fas fa-user-plus"></i> إضافة عضو
                        </button>
                    </div>
                `;
                
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }

            closeProjectDetail() {
                document.getElementById('projectDetailModal').classList.remove('show');
                document.body.style.overflow = 'auto';
                this.selectedProject = null;
            }

            updateProgress(projectId, event = null) {
                if (event) event.stopPropagation();
                
                const project = this.projectsData.projectsTable.find(p => p.id === projectId) ||
                             this.projectsData.activeProjects.find(p => p.id === projectId);
                
                if (project) {
                    const newProgress = prompt(`أدخل النسبة المئوية الجديدة للتقدم (${project.progress}% حالياً):`, project.progress);
                    
                    if (newProgress && !isNaN(newProgress) && newProgress >= 0 && newProgress <= 100) {
                        const progress = parseInt(newProgress);
                        project.progress = progress;
                        
                        // تحديث الحالة إذا اكتمل
                        if (progress === 100 && project.status !== 'completed') {
                            project.status = 'completed';
                            this.showToast('مبروك! تم إكمال المشروع بنجاح', 'success');
                        }
                        
                        this.saveData();
                        this.renderDashboard();
                        
                        this.showToast(`تم تحديث تقدم المشروع إلى ${progress}%`, 'success');
                    }
                }
            }

            messageTeam(projectId, event = null) {
                if (event) event.stopPropagation();
                
                const project = this.projectsData.projectsTable.find(p => p.id === projectId);
                if (project) {
                    const message = prompt(`رسالة لفريق مشروع ${project.name}:`, '');
                    if (message) {
                        this.showToast('تم إرسال الرسالة لفريق المشروع', 'success');
                    }
                }
            }

            showProjectActions(projectId, event) {
                if (event) event.stopPropagation();
                
                const project = this.projectsData.projectsTable.find(p => p.id === projectId);
                if (!project) return;
                
                const actions = [
                    { text: 'تحديث التقدم', icon: 'fa-chart-line', action: () => this.updateProgress(projectId) },
                    { text: 'مراسلة الفريق', icon: 'fa-comments', action: () => this.messageTeam(projectId) },
                    { text: 'إضافة مهمة', icon: 'fa-tasks', action: () => this.addTask(projectId) },
                    { text: 'تعديل البيانات', icon: 'fa-edit', action: () => this.editProject(projectId) },
                    { text: 'حذف المشروع', icon: 'fa-trash', action: () => this.deleteProject(projectId) }
                ];
                
                this.showActionMenu(actions, event.target);
            }

            showActionMenu(actions, targetElement) {
                const menu = document.createElement('div');
                menu.className = 'action-menu';
                menu.style.cssText = `
                    position: fixed;
                    background: var(--glass-bg);
                    backdrop-filter: var(--backdrop-blur);
                    -webkit-backdrop-filter: var(--backdrop-blur);
                    border: 1px solid var(--glass-border);
                    border-radius: 16px;
                    box-shadow: 0 8px 32px var(--shadow-heavy);
                    z-index: var(--z-modal);
                    min-width: 200px;
                    overflow: hidden;
                `;
                
                menu.innerHTML = actions.map(action => `
                    <div class="action-menu-item" 
                         onclick="${action.action.toString().replace(/"/g, '&quot;')}; this.parentElement.remove()"
                         style="padding: 16px; display: flex; align-items: center; gap: 12px; 
                                cursor: pointer; transition: all var(--transition-fast);
                                border-bottom: 1px solid var(--border-color);">
                        <i class="fas ${action.icon}" style="color: var(--primary-color);"></i>
                        <span style="flex: 1;">${action.text}</span>
                    </div>
                `).join('');
                
                const closeItem = document.createElement('div');
                closeItem.innerHTML = `
                    <div class="action-menu-item" 
                         onclick="this.parentElement.remove()"
                         style="padding: 16px; display: flex; align-items: center; gap: 12px; 
                                cursor: pointer; transition: all var(--transition-fast);">
                        <i class="fas fa-times" style="color: var(--danger-color);"></i>
                        <span style="flex: 1;">إغلاق</span>
                    </div>
                `;
                menu.appendChild(closeItem);
                
                const rect = targetElement.getBoundingClientRect();
                menu.style.top = `${rect.bottom + 10}px`;
                menu.style.right = `${window.innerWidth - rect.right}px`;
                
                document.body.appendChild(menu);
                
                setTimeout(() => {
                    const closeMenu = (e) => {
                        if (!menu.contains(e.target) && e.target !== targetElement) {
                            menu.remove();
                            document.removeEventListener('click', closeMenu);
                        }
                    };
                    document.addEventListener('click', closeMenu);
                }, 100);
            }

            addTask(projectId) {
                const project = this.projectsData.projectsTable.find(p => p.id === projectId);
                if (project) {
                    const task = prompt('أدخل وصف المهمة الجديدة:', '');
                    if (task) {
                        this.showToast('تم إضافة المهمة بنجاح', 'success');
                    }
                }
            }

            editProject(projectId) {
                const project = this.projectsData.projectsTable.find(p => p.id === projectId);
                if (project) {
                    this.showToast(`جاري فتح نموذج تعديل مشروع ${project.name}...`, 'info');
                }
            }

            deleteProject(projectId) {
                const project = this.projectsData.projectsTable.find(p => p.id === projectId);
                if (project) {
                    if (confirm(`هل أنت متأكد من حذف المشروع "${project.name}"؟`)) {
                        this.projectsData.projectsTable = this.projectsData.projectsTable.filter(p => p.id !== projectId);
                        this.projectsData.activeProjects = this.projectsData.activeProjects.filter(p => p.id !== projectId);
                        this.projectsData.summary.totalProjects--;
                        
                        if (project.status === 'active') {
                            this.projectsData.summary.activeProjects--;
                        }
                        
                        this.saveData();
                        this.renderDashboard();
                        this.showToast('تم حذف المشروع بنجاح', 'success');
                    }
                }
            }

            addTeamMember(projectId) {
                const project = this.projectsData.projectsTable.find(p => p.id === projectId);
                if (project) {
                    const memberName = prompt('اسم العضو الجديد:', '');
                    const memberRole = prompt('الدور:', '');
                    
                    if (memberName && memberRole) {
                        project.teamSize = (project.teamSize || 0) + 1;
                        this.saveData();
                        this.renderDashboard();
                        this.showToast('تم إضافة العضو الجديد بنجاح', 'success');
                    }
                }
            }

            // عرض الصفحات المختلفة
            viewAllProjects() {
                this.showToast('جاري فتح جميع المشاريع...', 'info');
            }

            viewActiveProjects() {
                this.showToast('جاري فتح المشاريع النشطة...', 'info');
            }

            viewRevenue() {
                this.showToast('جاري فتح تحليل الإيرادات...', 'info');
            }

            viewEfficiency() {
                this.showToast('جاري فتح تحليل الكفاءة...', 'info');
            }

            viewPerformanceDetails() {
                this.showToast('جاري فتح تحليل الأداء المتقدم...', 'info');
            }

            viewAllActiveProjects() {
                this.showToast('جاري فتح جميع المشاريع النشطة...', 'info');
            }

            viewTimeline() {
                this.showToast('جاري فتح الجدول الزمني الكامل...', 'info');
            }

            viewTeam() {
                this.showToast('جاري فتح إدارة فريق المشروع...', 'info');
            }

            exportReport() {
                this.showToast('جاري إنشاء تقرير المشاريع...', 'info');
                
                setTimeout(() => {
                    const report = {
                        title: 'تقرير إحصائيات المشاريع',
                        date: new Date().toLocaleDateString('ar-SA'),
                        summary: this.projectsData.summary,
                        totalProjects: this.projectsData.projectsTable.length
                    };
                    
                    this.showToast('تم إنشاء التقرير بنجاح', 'success');
                    console.log('تقرير المشاريع:', report);
                }, 2000);
            }

            exportTable() {
                this.showToast('جاري تصدير جدول المشاريع...', 'info');
                
                setTimeout(() => {
                    this.showToast('تم تصدير الجدول بنجاح', 'success');
                }, 1500);
            }

            createProject() {
                this.showToast('جاري فتح نموذج مشروع جديد...', 'info');
                
                setTimeout(() => {
                    const name = prompt('اسم المشروع الجديد:', '');
                    const client = prompt('اسم العميل:', '');
                    const value = prompt('قيمة المشروع (ريال):', '10000');
                    
                    if (name && client && value) {
                        const newProject = {
                            id: Date.now(),
                            name: name,
                            type: 'مشروع جديد',
                            status: 'pending',
                            progress: 0,
                            priority: 'medium',
                            value: parseInt(value),
                            client: client,
                            startDate: new Date().toISOString().split('T')[0],
                            deadline: this.addDays(new Date(), 30).toISOString().split('T')[0],
                            teamSize: 1,
                            department: 'development',
                            color: this.getRandomColor()
                        };
                        
                        this.projectsData.projectsTable.unshift(newProject);
                        this.projectsData.activeProjects.unshift({
                            id: newProject.id,
                            name: name,
                            client: client,
                            progress: 0,
                            status: 'active',
                            priority: 'medium',
                            value: parseInt(value),
                            deadline: newProject.deadline,
                            team: 1,
                            color: newProject.color
                        });
                        
                        this.projectsData.summary.totalProjects++;
                        this.projectsData.summary.activeProjects++;
                        this.projectsData.summary.revenue += parseInt(value);
                        
                        this.saveData();
                        this.renderDashboard();
                        
                        this.showToast('تم إنشاء المشروع الجديد بنجاح', 'success');
                    }
                }, 500);
            }

            addDays(date, days) {
                const result = new Date(date);
                result.setDate(result.getDate() + days);
                return result;
            }

            getRandomColor() {
                const colors = [
                    '#0a9396', '#ee9b00', '#9b5de5', '#2a9d8f', '#e76f51',
                    '#4cc9f0', '#ff6b6b', '#ffd166', '#06d6a0', '#118ab2'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            updateRealTimeData() {
                // محاكاة تحديث البيانات في الوقت الحقيقي
                if (Math.random() > 0.7) {
                    // تحديث تقدم مشروع عشوائي
                    const randomProject = this.projectsData.activeProjects[
                        Math.floor(Math.random() * this.projectsData.activeProjects.length)
                    ];
                    if (randomProject && randomProject.progress < 100) {
                        randomProject.progress += Math.floor(Math.random() * 3);
                        if (randomProject.progress > 100) randomProject.progress = 100;
                        
                        // تحديث المشروع في الجدول أيضاً
                        const tableProject = this.projectsData.projectsTable.find(p => p.id === randomProject.id);
                        if (tableProject) {
                            tableProject.progress = randomProject.progress;
                        }
                        
                        this.renderActiveProjects();
                    }
                }
            }

            simulateRealTimeUpdate() {
                const updates = [
                    'مشروع جديد تم إضافته',
                    'مشروع تم تحديث تقدمه',
                    'مهمة جديدة تم إضافتها',
                    'عضو جديد انضم للفريق'
                ];
                
                if (Math.random() > 0.8) {
                    const update = updates[Math.floor(Math.random() * updates.length)];
                    this.showToast(update, 'info');
                }
            }

            updateTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('ar-SA', {
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: true
                });
                document.getElementById('currentTime').textContent = timeString;
            }

            saveData() {
                localStorage.setItem('projectsStatsData', JSON.stringify(this.projectsData));
            }

            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                toast.className = 'toast-message';
                toast.style.cssText = `
                    position: fixed;
                    bottom: 120px;
                    left: 20px;
                    right: 20px;
                    background: ${type === 'success' ? 'linear-gradient(135deg, var(--success-color), #21867a)' : 
                                type === 'error' ? 'linear-gradient(135deg, var(--danger-color), #d1664b)' :
                                'linear-gradient(135deg, var(--primary-color), var(--accent-color))'};
                    color: white;
                    padding: 16px 20px;
                    border-radius: 16px;
                    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                    z-index: var(--z-toast);
                    animation: slideInUp 0.3s ease-out;
                    display: flex;
                    align-items: center;
                    gap: 12px;
                `;
                
                const icon = type === 'success' ? 'check-circle' : 
                           type === 'error' ? 'exclamation-circle' : 'info-circle';
                
                toast.innerHTML = `
                    <i class="fas fa-${icon}" style="font-size: 20px;"></i>
                    <div style="flex: 1; font-size: 14px;">${message}</div>
                `;
                
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateY(20px)';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }

            showWelcomeMessage() {
                setTimeout(() => {
                    this.showToast('مرحباً في نظام تحليل المشاريع المتقدم!', 'info');
                }, 1000);
            }
        }

        // تهيئة النظام
        let projectsStatsSystem;

        document.addEventListener('DOMContentLoaded', () => {
            projectsStatsSystem = new ProjectsStatsSystem();
        });

        // دالات الواجهة العامة
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const icon = document.querySelector('#darkModeToggle i');
            if (document.body.classList.contains('dark-mode')) {
                icon.className = 'fas fa-sun';
                localStorage.setItem('darkMode', 'true');
            } else {
                icon.className = 'fas fa-moon';
                localStorage.setItem('darkMode', 'false');
            }
            
            // تحديث الرسوم البيانية عند تغيير الوضع
            if (projectsStatsSystem) {
                setTimeout(() => {
                    projectsStatsSystem.initPerformanceChart();
                    projectsStatsSystem.initDistributionChart();
                }, 100);
            }
        }

        // التحقق من الوضع المحفوظ
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            document.querySelector('#darkModeToggle i').className = 'fas fa-sun';
        }

        // إضافة أنيميشن للرسوم البيانية
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInUp {
                from {
                    opacity: 0;
                    transform: translateY(40px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            @keyframes progressGrow {
                from {
                    width: 0;
                }
                to {
                    width: var(--progress-width);
                }
            }
            
            .project-stat {
                animation: slideInUp 0.6s ease-out;
            }
            
            .project-stat:nth-child(2) {
                animation-delay: 0.1s;
            }
            
            .project-stat:nth-child(3) {
                animation-delay: 0.2s;
            }
            
            .project-stat:nth-child(4) {
                animation-delay: 0.3s;
            }
            
            .action-menu-item:hover {
                background: var(--primary-color);
                color: white;
            }
            
            .action-menu-item:hover i {
                color: white !important;
            }
            
            .progress-fill, .progress-fill-table {
                animation: progressGrow 1s ease-out;
            }
            
            /* تحسينات للشاشات الصغيرة */
            @media (max-width: 768px) {
                .project-profile-stats {
                    grid-template-columns: repeat(2, 1fr);
                }
                
                .action-menu {
                    min-width: 180px !important;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>